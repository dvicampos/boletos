{% extends 'base.html' %}
{% block content %}
<h3 class="mt-5">ðŸ“Œ Pagos Pendientes</h3>
{% if pendientes %}
<table class="table table-bordered table-striped mt-3">
    <thead class="table-dark">
        <tr>
            <th>Cliente</th>
            <th>TelÃ©fono</th>
            <th>Evento</th>
            <th>Fecha que debÃ­a pagar</th>
        </tr>
    </thead>
    <tbody>
        {% for p in pendientes %}
        <tr>
            <td>{{ p.nombre }}</td>
            <td>{{ p.telefono }}</td>
            <td>{{ p.evento }}</td>
            <td>{{ p.fecha_recordatorio.strftime('%d/%m/%Y') }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p class="text-muted">No hay pagos pendientes hasta hoy ðŸ™Œ</p>
{% endif %}

<h1>ðŸ“Š Dashboard de Pagos y Recordatorios</h1>

<div id="grafica_recordatorios" style="width:100%;height:400px;"></div>
<div id="grafica_pagos" style="width:100%;height:400px;"></div>

<script>
    // ðŸ“© Recordatorios
    var recordatorios = {
        x: {{ recordatorios| map(attribute = 0) | list | tojson }},
    y: { { recordatorios | map(attribute = 2) | list | tojson } },
    type: 'bar',
        marker: { color: { { recordatorios | map(attribute = 1) | list | map('int') | list | tojson } } },
    text: { { recordatorios | map(attribute = 1) | list | tojson } },
        };
    Plotly.newPlot('grafica_recordatorios', [recordatorios], {
        title: 'Recordatorios Enviados vs Pendientes'
    });

    // ðŸ’° Pagos
    var pagos = {
        x: {{ pagos| map(attribute = 0) | list | tojson }},
    y: { { pagos | map(attribute = 1) | list | tojson } },
    type: 'scatter',
        mode: 'lines+markers',
            line: { shape: 'linear' }
        };
    Plotly.newPlot('grafica_pagos', [pagos], {
        title: 'Ingresos por Mes'
    });
</script>

{% endblock %}